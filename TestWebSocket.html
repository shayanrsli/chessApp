<!DOCTYPE html>
<html>
<head>
    <title>SignalR Simple Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.0/signalr.min.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { margin: 5px; padding: 10px; }
        .log { margin-top: 20px; padding: 10px; background: #f0f0f0; min-height: 200px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>ðŸ”§ ØªØ³Øª SignalR Ø³Ø§Ø¯Ù‡</h1>
    
    <button onclick="testHttp()">ØªØ³Øª HTTP</button>
    <button onclick="connectSignalR()">Ø§ØªØµØ§Ù„ SignalR</button>
    <button onclick="testPing()">ØªØ³Øª Ping</button>
    
    <div id="log" class="log"></div>

    <script>
        const log = document.getElementById('log');
        let connection = null;
        
        function addLog(msg, type = 'info') {
            const time = new Date().toLocaleTimeString();
            const div = document.createElement('div');
            div.innerHTML = `[${time}] ${msg}`;
            div.className = type;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }
        
        async function testHttp() {
            try {
                addLog('Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª HTTP...');
                const response = await fetch('http://localhost:5131/test');
                const text = await response.text();
                addLog(`âœ… HTTP Ù¾Ø§Ø³Ø®: ${text}`, 'success');
            } catch (error) {
                addLog(`âŒ HTTP Ø®Ø·Ø§: ${error.message}`, 'error');
            }
        }
        
        async function connectSignalR() {
            try {
                addLog('Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ SignalR...');
                
                connection = new signalR.HubConnectionBuilder()
                    .withUrl('http://localhost:5131/chessHub')
                    .withAutomaticReconnect()
                    .configureLogging(signalR.LogLevel.Information)
                    .build();
                
                connection.on('Connected', (data) => {
                    addLog(`âœ… Ù…ØªØµÙ„ Ø´Ø¯: ${JSON.stringify(data)}`, 'success');
                });
                
                connection.onclose((error) => {
                    addLog('ðŸ”Œ Ø§ØªØµØ§Ù„ Ù‚Ø·Ø¹ Ø´Ø¯', 'error');
                });
                
                await connection.start();
                addLog('ðŸš€ SignalR Ù…ØªØµÙ„ Ø´Ø¯!', 'success');
                
            } catch (error) {
                addLog(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„: ${error.message}`, 'error');
                console.error('Error details:', error);
            }
        }
        
        async function testPing() {
            if (!connection) {
                addLog('âŒ Ø§ÙˆÙ„ Ø¨Ù‡ SignalR Ù…ØªØµÙ„ Ø´ÙˆÛŒØ¯', 'error');
                return;
            }
            
            try {
                addLog('Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ping...');
                const result = await connection.invoke('Ping');
                addLog(`âœ… Ping Ù¾Ø§Ø³Ø®: ${result}`, 'success');
            } catch (error) {
                addLog(`âŒ Ping Ø®Ø·Ø§: ${error.message}`, 'error');
            }
        }
        
        // ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø±
        setTimeout(() => {
            testHttp();
        }, 1000);
    </script>
</body>
</html>